# CVE-2023-49438

## Proof of Concept

![flask-security-too-open-redirect](https://github.com/brandon-t-elliott/CVE-2023-49438/assets/126433368/e0f0383b-bc74-43fb-a5e0-de5901a447fd)

An open redirect vulnerability in the python package [Flask-Security-Too](https://github.com/Flask-Middleware/flask-security/) <=version 5.3.2 allows attackers to redirect unsuspecting users to malicious sites via a crafted URL by abusing the ?next parameter on the /login and /register routes.

Although the Flask-Security-Too python package was previously found to be vulnerable to this and version 4.1.0 claimed to patch it (and previous examples such as `https://example/login?next=\\\github.com` were indeed patched), a workaround was discovered which still makes the package vulnerable as of version 5.3.2.

## Examples

`https://example/login?next=/\github.com`

`https://example/login?next=\/github.com`

## CVE Reference

[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-49438](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-49438)

## Credit

Discovered by [Brandon T. Elliott](https://www.linkedin.com/in/brandon-t-elliott/), November 2023
